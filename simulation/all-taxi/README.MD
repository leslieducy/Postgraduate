## 聚类
新建道路属性表，并手动新建CLUSTER_TYPE字段，并通过聚类（层次）算法得到不同道路所属的类别（即区域），更新回CLUSTER_TYPE字段。

## 所有的司机，不同的选择方式
- 随机选择：订单随机选择，无订单时随机选路
- 贪心选择：订单选择最大的，无订单时选择属于收益最大区域的路（选择最大的几个订单那里还可以稍微改进一下）
- 评估订单：根据订单即将达到的区域来判断增加潜在收入，评估定订单的价值。
- 强化学习：通过深度学习学习即将达到的区域的潜在收入，作出选择。

### 1、 数据模型
car(司机类)：每个司机可以的操作，有订单接订单；5分钟没订单，游荡到下一个路段。

reqday（订单发布平台）：记录平台所有订单的情况，避免冲突

road（道路类）：更方便的获取路段的属性

### 2、 选择方式
随机选择：52331.99498117942, 52508.78293601004, 52042.40903387704
贪心选择：51603.63864491844, 51674.78042659975, 52272.02007528231
评估订单：52345.04391468005, 52131.11668757842, 52561.35508155583, 52315.80928481807
强化学习：49781.30489335006, 50461.48055207026, 50918.69510664994, 51819.8243412798, 51590.21329987453

### 3、辅助SQL查询
```
获取该天每个区域的总金额，用于评估区域
语句：
 select CLUSTER_TYPE,sum(costs) from ROAD_PROP t,(select start_road,sum(cost) as costs from TEM_REQ t group by start_road) r where t.ROAD_ID=r.start_road group by CLUSTER_TYPE order by sum(costs) desc
结果：
6	3261303620
2	2644065908
0	1981736600
4	1557090526
3	885348000
5	599893800
7	424014600
1	365509620
```

### 4、使用强化学习解决订单选择问题：
共通点：
1、需要考虑即时收益与潜在收益
2、每次不同的选择都带来不同的收益
难点：状态集、动作集、回报的确定
其他思路：
对订单进行评价，给出评价值，通过模拟反馈，不断改进神经网络。
拟采用GAN神经网络设计的方法（适用度，缺点，需注意的细节）
G：生成评分：多个输入，两层隐藏层，一个输出
D：评价评分是高了还是低了
损失函数：
G：根据D的评价结果进行梯度下降
D：根据模拟的未来情况进行梯度下降

训练集：模拟数据。
G数据集：起始位置，终止位置，订单发起时间，司机已工作时长，金额，=> 一个评分值
D数据集：司机ID，评分，订单累计时间，终止位置周围的订单数，终止位置周围的订单总金额，终止位置周围的订单最大值 => 三类（评分高了，评分合理，评分低了）

意义：
从全局看，一定会存在对司机不利的订单，比如，偏远地区的订单，这些订单也会产生打不到车的问题；
从司机角度看，能有效避免该类订单，可以获得更多的收益；
从平台角度，对该类订单进行补偿，可以有效提高订单的完成率和司机的满意度；
从客户角度，如果有急事，也可以通过提高该笔订单的价格，来达到节约时间，从而解决打车难的问题。

## 数据集：
### 1. 司机表设计（taximan）
|字段名|类型|值介绍|
|:-|:-|:-|
|taximan_ID|number|一共1252个司机|
|start_time|time|0:01:00 - 23:59:00，每天大概五万个订单,跨天订单以起始时间为主，时间具体到分钟|
|end-time|time|0:01:00 - 23:59:00|
|day_no|string|2013-03-01 - 2013-05-20，共计81天（5月21日到30日数据有问题，订单一共才19个，所以暂不考虑）|
|income|number|司机当天的收入，价格单位（分）|
|start_LNG|float|司机当天开始工作的起始位置经度|
|start_LAT|float|司机当天开始工作的起始位置纬度|
|start_road|number|司机当天开始工作的起始位置(由经纬度得到)|
|end_LNG|float|司机当天结束工作的最终位置经度|
|end_LAT|float|司机当天结束工作的最终位置纬度|
|end_road|number|司机当天结束工作的最终位置(由经纬度得到)|
### 2. 订单表设计（request）
|字段名|类型|值介绍|
|:-|:-|:-|
|request_ID|number|每天大概5万个订单|
|day_no|string|2013-03-01 - 2013-05-20，共计81天|
|cost|number|订单花费，价格单位（分），起步6元（600分），每天最高有100-500元|
|on_time|time|0:01:00 - 23:59:00，订单发出时间|
|on_LNG|float|订单的起始位置经度|
|on_LAT|float|订单的起始位置纬度|
|on_road|number|订单的起始位置(由经纬度得到)|
|off_time|time|0:01:00 - 23:59:00，订单预计结束时间|
|off_LNG|float|订单的目的位置经度|
|off_LAT|float|订单的目的位置纬度|
|off_road|number|订单的目的位置(由经纬度得到)|
### 3. 邻路表设计（neighbor）
|字段名|类型|值介绍|
|:-|:-|:-|
|pri_road|number|路段号|
|nei_road|number|一个相邻的路段号|
